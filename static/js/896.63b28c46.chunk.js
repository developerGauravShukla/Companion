"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[896],{6713:(e,t,o)=>{o.d(t,{A:()=>a});o(5043);var s=o(579);const a=()=>(0,s.jsx)("div",{className:"loader-container",children:(0,s.jsx)("div",{className:"loader"})})},1397:(e,t,o)=>{o.d(t,{A:()=>d});var s=o(5043),a=o(1666),n=o(2691),r=o(4282),i=o(3910),l=o(7929),c=o(579);const d=e=>{let{onSearch:t,disabled:o}=e;const[d,u]=(0,s.useState)(""),g=(0,s.useRef)(null);return(0,c.jsxs)("div",{className:"search-content-container d-flex align-items-center",children:[(0,c.jsx)(i.g,{icon:l.$UM,onClick:()=>{d.trim()&&t(d)},className:"search-icon"}),(0,c.jsx)("span",{className:"ms-4 drag-and-drop-text flex-grow-1",children:(0,c.jsxs)(a.A,{children:[(0,c.jsx)(n.A.Control,{type:"text",ref:g,value:d,onChange:e=>{const t=e.target.value;u(t)},onKeyDown:e=>{"Enter"===e.key&&d.trim()&&t(d)},placeholder:"Search...",disabled:o}),d&&(0,c.jsx)(r.A,{variant:"btn-link",onClick:()=>{u(""),g.current.focus()},className:"clear-button",children:"\u2716"})]})})]})}},4675:(e,t,o)=>{o.d(t,{A:()=>r});var s=o(9379),a=o(5043),n=o(6047);const r=()=>{const[e,t]=(0,a.useState)(null),[o,r]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{try{const e=await(0,n.qZ)();r(e)}catch(e){console.error("[useInterComSearch] Error initializing InterCom:",e)}})()}),[]),(0,a.useEffect)((()=>()=>{e&&e.disconnect()}),[e]);return{performSearch:(0,a.useCallback)(((e,a,n)=>{var r;if(!o)return void console.warn("[useInterComSearch] InterCom is not loaded yet.");const i="socket"+(new Date).toISOString().replace(/[-:]/g,""),l=new o.Socket(i,{dispatchRetryInternal:0});l.subscribeServer("SearchComServer"),t(l),console.log("[useInterComSearch] performSearch called with:",e,a);const c=null===(r=window.widget)||void 0===r?void 0:r.id,d=(0,s.A)((0,s.A)({},a),{},{widget_id:c,app_socket_id:i,default_search_criteria:e});console.log("[useInterComSearch] Dispatching RegisterContext event with:",d),l.dispatchEvent("RegisterContext",d),l.dispatchEvent("InContextSearch",d);console.log("[useInterComSearch] Adding listener for Selected_Objects_search"),l.addListener("Selected_Objects_search",(e=>{console.log("[useInterComSearch] Search results received:",e),n&&n(e)}))}),[o])}}},2676:(e,t,o)=>{o.d(t,{A:()=>f});var s=o(3003),a=o(9379),n=o(6047);var r=o(9332);const i=async(e,t)=>{let o={CAAtt:[]};console.log("We are into Search CA Details");const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";try{const r=await(0,n.fV)(),i=async e=>new Promise(((o,s)=>{r.authenticatedRequest(e,{method:"GET",headers:t,type:"json",onComplete:e=>{console.log("Received response:",e),o(e)},onFailure:e=>{console.error("Request failed:",e),s(e)}})}));let l="".concat(s,"/resources/v1/modeler/dsrt/routes/search?searchStr=").concat(e);const c=await i(l),d=((null===c||void 0===c?void 0:c.data)||[]).find((e=>"Route"===e.type));if(d){const t=d.identifier,a=d.state,n="".concat(s,"/resources/v1/modeler/dsrt/routes/").concat(t),r=await i(n),l=((null===r||void 0===r?void 0:r.data)||[]).find((e=>"Change Action"===e.type));if(l){const e=l.identifier,t="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(e,"?$fields=proposedChanges,flowDown"),a=await i(t);if(a)for(const n of a.isFlowDownOf||[])if("Change Action"===n.type){const e="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(n.identifier),t=await i(e);t&&o.CAAtt.push({CATitle:t.title,CAState:t.state})}}o.MCOState=a,o.MCOTitle=e}else{var a;const t=e.split("-").slice(0,2).join("-");let n="".concat(s,"/resources/v1/modeler/dslc/changeaction/search?$searchStr=name:").concat(t);const r=null===(a=(await i(n)).changeAction[0])||void 0===a?void 0:a.identifier,l="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(r,"?$fields=proposedChanges,flowDown"),c=await i(l);if(c)for(const e of c.isFlowDownOf||[])if("Change Action"===e.type){const t="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(e.identifier),a=await i(t);a&&o.CAAtt.push({CATitle:a.title,CAState:a.state})}o.MCOState="Complete",o.MCOTitle=e}return console.log("Final CA Details",o),o}catch(r){throw console.error("Error in SearchCA:",r),r}};var l=o(9722);const c=async(e,t,o,s,a)=>{try{const t="https://oi000186152-us1-space.3dexperience.3ds.com/enovia",s=await async function(e,t,o){const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia",a="".concat(s,"/resources/v1/modeler/dslc/version/getGraph");let r="";try{const i={data:[{id:e,identifier:e,type:t,source:s,relativePath:"Raw_Material"===t?"/resources/v1/modeler/dsrm/dsrm:RawMaterial/".concat(e):"/resources/v1/modeler/dseng/dseng:EngItem/".concat(e)}]},l=await(0,n.ui)("POST",a,i,o);if(l.status&&l.output){const t=l.output.results[0].versions;for(const o of t)if(o.identifier===e&&(console.log("Found matching version for ID:",e),Array.isArray(o.ancestors)&&o.ancestors.length>0)){r=o.ancestors[0].id,console.log("Ancestor ID:",r);break}return r}return console.error("API response does not contain the expected 'status' and 'output'."),r}catch(i){return console.error("Error fetching getLatestRevision for ".concat(e,":"),i),r}}(o,a,e);if(console.log("Hello getLatestRevision is Called",s),""===s)return console.warn("No latest revision ID found."),[];{const c="".concat(t,"/resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/").concat(s,"?$mask=dslib:ClassificationAttributesMask"),u=await(0,n.ui)("GET",c,"",e);if(!u.status||!u.output)return console.error("Invalid classification response from ENOVIA."),[];{var r,i;const e=((null===(r=u.output.member[0])||void 0===r||null===(i=r.ClassificationAttributes)||void 0===i?void 0:i.member)||[]).filter((e=>e.Attributes.some((e=>"PlantAssignmentClass"===e.name&&!0===e.value)))).map((e=>{const t=e.Attributes.map((e=>"Seq"===e.name?{name:e.name,value:String(Number(e.value)+1)}:"PlantStatus"===e.name?{name:e.name,value:"Pending"}:"AddSeq"===e.name||"PlantAssignmentClass"===e.name?{name:e.name,value:e.value}:{name:e.name,value:""}));return{ClassID:e.ClassID,Attributes:t}}));if(console.log("Matching ClassID and Seq:",e),!(e.length>0))return console.warn("No matching classifications found with Plant = True."),[];{const s="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",n={id:o,type:a,classes:e.map((e=>e.ClassID)),mode:"classifyParent"};try{const a=await d("POST",s,n);console.log("classifyResponse:",JSON.stringify(a));const r={source:t,type:"dslib:CategorizationClassifiedItem",identifier:o,relativePath:"resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/".concat(o)},i=[{referencedObject:r,categorizationAttributes:e.map((e=>({classId:e.ClassID,attributes:e.Attributes.reduce(((e,t)=>(e[t.name]=t.value,e)),{})})))}];console.log("Prepared payload for second API call:",JSON.stringify(i));const l="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/updateClassificationAttribute?id=".concat(o),c=await d("PATCH",l,i);return console.log("Second API call response:",JSON.stringify(c)),e}catch(l){return console.error("Error during classify or second API call:",l),[]}}}}}catch(l){return console.error("[updateClasses] Failed to process:",l),[]}};const d=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GET",t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("Fetching URL:",t),console.log("Method is:"),console.log("Request Body:",JSON.stringify(o,null,2));try{const s=await(0,l.A)({url:t,method:e,data:o});return console.log("Response received:",s.data),s}catch(s){throw console.error("Request failed:",s),s}};var u=o(5645),g=(o(5043),o(3277)),p=o(2725),m=o(2268);const h="https://oi000186152-us1-space.3dexperience.3ds.com/enovia",f=()=>{const{showErrorToast:e}=(0,p.A)(),t=(0,s.wA)();let o=window.widget.getValue("email");console.log("Email in usePlantAssignment:",o);return{handlePlantAssignment:async(s,l,d,p)=>{try{t((0,u.Ve)(!0));const f=await(0,m.I)();if(!f)return void e(g.rK);console.log("[UsePlantAssignment] Headers:",f);let v=[];if("Change Action"===p){const e=async()=>{const e=await(0,r.g)([s],f,d);return console.log("Parallel API response:",e),t((0,u.QL)(e)),e};let o=!1;console.log("The object Type is Change Action");const a=async e=>{const t="".concat(h,"/resources/v1/modeler/dslc/changeaction/").concat(d,"?%24fields=proposedChanges,realizedChanges"),s=await(0,n.ui)("GET",t,"",f);if(console.log("Response from Change Action URL:",s),s.status&&s.output){const t=s.output.realizedChanges.map((e=>e.where.identifier)),a=s.output.proposedChanges.map((async s=>{let a=s.where.identifier,r=s.where.type;if("Raw_Material"==r||"VPMReference"==r||"CreateAssembly"==r||"Provide"==r||"CreateMaterial"==r){if("NewVersion"===s.target){const e=await async function(e,t,o){const s="".concat(h,"/resources/v1/modeler/dslc/version/getGraph"),a="";try{const i="Raw_Material"===t?"/resources/v1/modeler/dsrm/dsrm:RawMaterial/".concat(e):"/resources/v1/modeler/dseng/dseng:EngItem/".concat(e),l={data:[{id:e,identifier:e,type:t,source:h,relativePath:i}]},c=await(0,n.ui)("POST",s,l,o);if(!c.status||!c.output)return console.error("API response does not contain the expected 'status' and 'output'."),a;{var r;const t=(null===(r=c.output.results[0])||void 0===r?void 0:r.versions)||[];for(const o of t)if(o.ancestors&&o.ancestors.some((t=>t.identifier===e)))return o.id}}catch(i){return console.error("Error fetching getLatestRevision for ".concat(e,":"),i),a}}(a,r,f);t.includes(e)&&(a=e)}if("Raw_Material"!==r&&"VPMReference"!==r){o=!0;const e=await async function(e,t){let o="";o="".concat(h,"/resources/v1/modeler/dsmfg/dsmfg:MfgItem/").concat(e,"/dsmfg:ScopeEngItem");try{const s=await(0,n.ui)("GET",o,"",t);return s.status&&s.output?{identifier:s.output.member[0].ScopeEngItem.identifier,type:s.output.member[0].ScopeEngItem.type}:(console.log("No valid response for identifier ".concat(e)),{})}catch(s){return console.error("Error fetching item details for ".concat(e,":"),s),{}}}(a,f);console.log("MFG Details are:",e),a=e.identifier,r=e.type}if(void 0!==a&&void 0!==r)try{var i,l,d,u;const t=await async function(e,t,o){let s="";s="Raw_Material"===t?"".concat(h,"/resources/v1/modeler/dsrm/dsrm:RawMaterial/").concat(e):"".concat(h,"/resources/v1/modeler/dseng/dseng:EngItem/").concat(e,"?mask=dsmveng:EngItemMask.Details");try{const t=await(0,n.ui)("GET",s,"",o);return t.status&&t.output?t.output:(console.log("No valid response for identifier ".concat(e)),{})}catch(a){return console.error("Error fetching item details for ".concat(e,":"),a),{}}}(a,r,f),o=(null===t||void 0===t||null===(i=t.member)||void 0===i||null===(l=i[0])||void 0===l||l.state,await async function(e,t,o,s,a){const r=[];let i=!1;const l="".concat(h,"/resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/").concat(e,"?$mask=dslib:ClassificationAttributesMask");try{var d,u;const s=await(0,n.ui)("GET",l,"",t);console.log("Response for identifier ".concat(e,":"),s);let g=(null===(d=s.output.member[0])||void 0===d||null===(u=d.ClassificationAttributes)||void 0===u?void 0:u.member)||[];g=g.filter((e=>{const t=e.Attributes.find((e=>"PlantAssignmentClass"===e.name)),o=e.Attributes.find((e=>"AllPlantsRemoved"===e.name));return!0===(null===t||void 0===t?void 0:t.value)||!0===(null===o||void 0===o?void 0:o.value)})),0===g.length&&(g=await c(t,0,e,0,a)),i=g.some((e=>{const t=e.Attributes.find((e=>"AllPlantsRemoved"===e.name));return!0===(null===t||void 0===t?void 0:t.value)})),g.length>0?g.forEach((e=>{const t=e.ClassID;let s=null,a=null,n=!1,i="";var l;(e.Attributes.forEach((e=>{e.name.includes("PlantAssignmentClass")&&(n=e.value),e.name.includes("PlantStatus")&&(a=e.value),e.name.includes("FlowDownCA")&&(i=e.value)})),n)&&(s=null===(l=o.find((e=>e.id===t)))||void 0===l?void 0:l.title,s&&r.push({PlantName:s,PlantID:t,PlantERPStatus:a||"Pending",PlantFlowDownCA:i}))})):console.log("No valid classification data for identifier ".concat(e))}catch(g){console.error("Error fetching assigned classes for ".concat(e,":"),g)}return{ItemPlants:r,hasNoPlants:i}}(a,f,e,0,p)),s=o.ItemPlants,g=o.hasNoPlants;console.log("Item Plants are:",s),console.log("Has No Plants are:",g),console.log("ItemObjectdetails:",o),v.push({ItemId:a,ItemType:r,ItemState:(null===t||void 0===t?void 0:t.member[0].state)||"N/A",ItemTitle:(null===t||void 0===t?void 0:t.member[0].title)||"N/A",ItemMBOM:(null===t||void 0===t||null===(d=t.member[0])||void 0===d||null===(u=d["dseno:EnterpriseAttributes"])||void 0===u?void 0:u.EMR_hasMBOM)||"N/A",ItemPlants:s,hasNoPlants:g})}catch(g){console.error("Error processing change for item ".concat(a,":"),g)}}}));await Promise.all(a)}else console.error("Invalid response structure or no proposed changes.")},i=await e();await a(i),t((0,u.Ve)(!1)),t((0,u.OL)(v)),t((0,u.Dr)(o)),t((0,u.lT)(f))}else{const e=await(async(e,t,o)=>{try{const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[UserGroup Status] ProductId: ",t);const r=await(0,n.fV)();let i="".concat(s,"/resources/v1/modeler/dslc/sharing/getSharing");const l=await new Promise(((o,s)=>{r.authenticatedRequest(i,{method:"POST",headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify({data:[{objectID:t}]}),type:"json",onComplete:o,onFailure:s})}));console.log("[Assigned Plant Service] Data received:",l);let c=[],d={groups:[]};if(l&&(l.results.forEach((e=>{e.sharings.userGroups.forEach((e=>{"Can Edit"===e.access&&d.groups.push({uri:e.userGroupID.replace(/[<>]/g,"")})}))})),d.groups.length>0)){let e="https://oi000186152-us1-usersgroup.3dexperience.3ds.com/3drdfpersist/resources/v1/usersgroup/groups?select=uri,members,title";const t=await new Promise(((t,o)=>{r.authenticatedRequest(e,{method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(d),type:"json",onComplete:t,onFailure:o})}));console.log("Group Response is:",t),t&&(c=t.groups.filter((e=>e.members.includes(o))).map((e=>e.title)))}return console.log("[UserGroup Status] User Groups:",c),c}catch(s){throw console.error("[UserGroup Status] Error occurred:",s),s}})(f,d,o);console.log("[Plant Assignment] User Groups:",e);let g=[...e,s];console.log("[Use Plant Assignment] All CollabSpaces:",g);let m=[];if(g.length>0?(m=await(0,r.g)(g,f,d),console.log("[Use Plant Assignment] All Plants:",m)):console.warn("[Use Plant Assignment] No CollabSpaces found."),m.length>0){const e=await(async(e,t,o,s,a)=>{try{var r;const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[Assigned Plant Service] Plant Members:",e);const l="".concat(s,"/resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/").concat(o,"?$mask=dslib:ClassificationAttributesMask"),d=await(0,n.fV)(),u=await new Promise(((e,o)=>{d.authenticatedRequest(l,{method:"GET",headers:t,type:"json",onComplete:e,onFailure:o})}));console.log("[Assigned Plant Service] Data received:",u);let g=[],p=[],m=(null===(r=u.member[0].ClassificationAttributes)||void 0===r?void 0:r.member)||[];m=m.filter((e=>{const t=e.Attributes.find((e=>"PlantAssignmentClass"===e.name)),o=e.Attributes.find((e=>"AllPlantsRemoved"===e.name));return!0===(null===t||void 0===t?void 0:t.value)||!0===(null===o||void 0===o?void 0:o.value)}));const h=m.some((e=>{const t=e.Attributes.find((e=>"AllPlantsRemoved"===e.name));return!0===(null===t||void 0===t?void 0:t.value)}));return 0===m.length&&(m=await c(t,0,o,0,a)),await Promise.all(m.map((async o=>{console.log("Class Item is ",o);for(let s of e)if(o.ClassID===s.id){let e=s.title;e=e.replace("Plant","").replace(/\s+/g,"");let a={id:o.ClassID,title:s.title};const n=o.Attributes.map((o=>o.name.includes("FlowDownCA")&&o.value?i(o.value,t).then((e=>{if(e){console.log(e),a.MFGChange=null===e||void 0===e?void 0:e.MCOTitle,a.MFGStatus=null===e||void 0===e?void 0:e.MCOState;let t="",o="";e.CAAtt.forEach((e=>{t+=","+e.CATitle,o+=","+e.CAState})),a.Change=t.slice(1),a.ChangeStatus=o.slice(1)}})):(a[o.name.replace(e,"").trim()]=o.value,Promise.resolve())));await Promise.all(n),g=[...g,a],console.log("Initial Assigned Classes",g),console.log("Processed Object:",a)}}))),console.log("[Assigned Plant Service] Initial Assigned Classes:",g),p=e.filter((e=>!g.some((t=>t.id===e.id)))),console.log("uniqueInAllclasses--:",p),{success:!0,data:{plantData:{allPlants:e,initialAssignedPlants:g,uniquePlants:p,hasNoClass:h}}}}catch(l){return console.error("[Object Details] Failed to fetch data:",l),{success:!1,error:l}}})(m,f,d,0,p);console.log("[Use Plant Assignment]: ",e),e.success?(t((0,u.Lq)(e.data.plantData)),t((0,u.lL)(f))):console.error("Failed to fetch plant data.")}else console.warn("[Use Plant Assignment] No Plants found.");let h={};h="Raw_Material"===p?{success:!0,data:[]}:await(async(e,t)=>{const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let s="".concat(o,"/resources/v1/modeler/dseng/dseng:EngItem/");s+=t,s+="/expand";let r={expandDepth:1,type_filter_bo:["VPMReference"],type_filter_rel:["VPMInstance"]};try{console.log("[SearchCAService] ProductId is:",t);const i=await(0,n.fV)(),l=(t,o,s)=>new Promise(((n,r)=>{i.authenticatedRequest(t,{method:o,headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(s),type:"json",onComplete:e=>{console.log("Received response:",e),n(e)},onFailure:e=>{console.error("Request failed:",e),r(e)}})})),c=await l(s,"POST",r);console.log("[Get CA Details Service] Data received:",c);const{member:d}=c;if(d){let e=c.member.filter((e=>("VPMReference"===e.type||"Raw_Material"===e.type)&&e.id!==t)).map((e=>({id:e.id,type:e.type,name:e.title,state:e.state})));return e.length>0&&await Promise.all(e.map((async e=>{if("released"===e.state.toLowerCase()){let t="".concat(o,"/resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/").concat(e.id,"?$mask=dslib:ClassificationAttributesMask");const s=await l(t,"GET","");console.log("classResponse->",s);const a=s.member.flatMap((e=>{var t;return null!==(t=e.ClassificationAttributes)&&void 0!==t&&t.member?e.ClassificationAttributes.member.map((e=>e.ClassID)):[]}));e.classes=a}}))),{success:!0,data:e}}}catch(i){return console.error("Error while Fetching",i),{success:!1,data:[],error:i}}})(f,d),console.log("Type After:",p),console.log("[Use Plant Assignment] Product Children:",h),h.success&&t((0,u.VG)(h.data));const v=await(async(e,t,o)=>{const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let r=!1,i=[],l={CAName:"",CAStatus:""};const c=["caproposedwhere_from","carealizedwhere_from"],d="".concat(s,"/resources/enorelnav/v2/navigate/setPreferences");let u={widgetId:"ENORIPE_Relations_Preview_2751_2038-15:33:22",relations:["caproposedwhere_from","carealizedwhere_from"],allRelationsMode:!1,publicationsMode:!1,computeWithInstances:!1,attributesForView:["ds6w:status","ds6w:type","ds6w:identifier","ds6w:label"],label:"ENXENG_AP-e1331143-1734517777960",lang:"en",ghostMode:!1},g="".concat(s,"/resources/enorelnav/v2/navigate/getEcosystem"),p={widgetId:"ENORIPE_Relations_Preview_2751_2038-15:33:22",responseMode:"objectsByPatterns",label:"ENXENG_AP-e1331143-1734517780491",ids:[t]};try{console.log("[Get CA Details] Product ID:",t);const m=await(0,n.fV)(),h=await new Promise(((t,o)=>{m.authenticatedRequest(d,{method:"POST",headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(u),type:"json",onComplete:t,onFailure:o})}));if(console.log("[Get CA Details Service] Data received:",h),"OK"===h.status){const n=await new Promise(((t,o)=>{m.authenticatedRequest(g,{method:"POST",headers:(0,a.A)((0,a.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(p),type:"json",onComplete:t,onFailure:o})}));console.log("[Get CA Details Service] Data received:",n);for(const a of c)n.objectsByPatterns[a]&&await Promise.all(n.objectsByPatterns[a].map((async n=>{const c=n["ds6w:status"].slice(14),d=n["ds6w:label"];if("Complete"!==c){const u="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(n.id,"?$fields=proposedChanges,realizedChanges,flowDown"),g=await new Promise(((t,o)=>{m.authenticatedRequest(u,{method:"GET",headers:e,type:"json",onComplete:t,onFailure:o})}));console.log("response3 Data will appear:",g),"caproposedwhere_from"===a?Array.isArray(g.proposedChanges)&&g.proposedChanges.forEach((e=>{i.push({identifier:e.where.identifier,action:e.whats[0].what})})):Array.isArray(g.realizedChanges)&&g.realizedChanges.forEach((e=>{i.push({identifier:e.where.identifier,action:e.operations[0]})})),r="released"!==o.toLowerCase()||i.some((e=>e.identifier===t&&"Modify"===e.action)),r&&(l.CAName=d,l.CAStatus=c)}})))}else console.error("Unable to Fetch the ");return console.log("Status is coming inside 7"),console.log("Response Object is:",r),{success:!0,data:r,CAData:l,proposedChanges:i}}catch(m){throw console.error("Failed Request:",{url:d,headers:e,body:u,error:m}),m}})(f,d,l);console.log("[Use Plant Assignment] CA Details:",v),v.success&&(t((0,u.ug)(v.data)),t((0,u.aB)(v.proposedChanges)),t((0,u.hF)(v.CAData))),console.log("[Plant Assignment] All services executed successfully.")}}catch(f){console.error("[Plant Assignment] Error:",f),e("An error occurred while fetching plant assignment data.")}finally{t((0,u.Ve)(!1))}}}}},7419:(e,t,o)=>{o.d(t,{A:()=>d});var s=o(5043),a=o(3003),n=o(5645),r=o(2676),i=o(314),l=o(2725),c=o(3277);const d=()=>{const{showErrorToast:e}=(0,l.A)(),{handlePlantAssignment:t}=(0,r.A)(),o=(0,a.d4)((e=>e.droppedObject.isDropped)),d=(0,a.d4)((e=>e.droppedObject.loading)),u=(0,a.wA)(),g=(0,s.useCallback)((async o=>{try{const r=await(0,i.Sj)({dataItems:o});if(r.success){u((0,n.um)({cardData:r.data.cardData}));const e=r.data.cardData;var s,a;if(console.log("[Dragged Items are]",e),u((0,n.Rr)(!0)),r)await t(e["Collaborative Space"],e["Maturity State"],null===(s=o[0])||void 0===s?void 0:s.objectId,null===(a=o[0])||void 0===a?void 0:a.objectType)}else e(c.wX)}catch(r){console.error("[FetchObjectDetails] Error fetching details:",r),e(c.wX)}finally{u((0,n.r1)(!1))}}),[u,t]),p=(0,s.useCallback)((async t=>{console.log("[handleDrop] handleDrop called with dataItems:",t);try{if(t&&t.length>0){var o;const s=null===(o=t[0])||void 0===o?void 0:o.objectType;if(!["VPMReference","Raw_Material","Change Action"].includes(s))return void e(c.Zo);u((0,n.Rr)(!0)),console.log("[handleDrop] \ud83d\udd04 Force setting `loading = true`..."),u((0,n.r1)(!1)),setTimeout((()=>u((0,n.r1)(!0))),0),await g(t)}else console.warn("[handleDrop] No data items to process.")}catch(s){console.error("[Drop] Error in handleDrop:",s),u((0,n.r1)(!1)),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(c.nz)}}),[g,e]);return{initializeDroppableArea:(0,s.useCallback)((()=>{o?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),u((0,n.Rr)(!1)));const t=setInterval((()=>{const o=document.querySelector(".droppable-container");o&&(clearInterval(t),(0,i.pn)(o,p,u,e))}),100);return()=>clearInterval(t)}),[p,u]),loading:d,handleDrop:p}}},2725:(e,t,o)=>{o.d(t,{A:()=>c,_:()=>l});var s=o(9379),a=o(45),n=o(2115);const r=["message","type","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","pauseOnFocusLoss","draggable","theme","transition","progress"],i=()=>{const e=e=>{let{message:t,type:o="default",position:i="top-right",autoClose:l=2e3,hideProgressBar:c=!1,closeOnClick:d=!0,pauseOnHover:u=!1,pauseOnFocusLoss:g=!1,draggable:p=!0,theme:m="light",transition:h=n.br,progress:f}=e,v=(0,a.A)(e,r);(n.oR[o]||n.oR)(t,(0,s.A)({position:i,autoClose:l,hideProgressBar:c,closeOnClick:d,pauseOnHover:u,draggable:p,theme:m,transition:h,progress:f},v))};return{showToast:e,showSuccessToast:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,s.A)({message:t,type:"success"},o))},showErrorToast:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,s.A)({message:t,type:"error"},o))},showInfoToast:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,s.A)({message:t,type:"info"},o))},showWarningToast:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,s.A)({message:t,type:"warn"},o))}}},l=()=>{const{showToast:e,showSuccessToast:t,showErrorToast:o,showInfoToast:a,showWarningToast:n}=i();return{showToastWithProgress:function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e((0,s.A)({message:t,progress:1},o))},showSuccessToastWithProgress:function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(e,(0,s.A)({progress:1},o))},showErrorToastWithProgress:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(e,(0,s.A)({progress:1},t))},showInfoToastWithProgress:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(e,(0,s.A)({progress:1},t))},showWarningToastWithProgress:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(e,(0,s.A)({progress:1},t))}}},c=i},9332:(e,t,o)=>{o.d(t,{g:()=>a});var s=o(6047);const a=async(e,t,o)=>{try{const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let a=[];console.log("[All Plant Service] CollabSpaces: ",e),console.log("[All Plant Service] headers: ",t);const n=await(0,s.fV)(),r=async e=>new Promise(((o,s)=>{n.authenticatedRequest(e,{method:"GET",headers:t,type:"json",onComplete:e=>{console.log("Received response:",e),o(e)},onFailure:e=>{console.error("Request failed:",e),s(e)}})})),i=e.map((async e=>{try{var t,s;const c="".concat(o,"/resources/v1/modeler/dslib/dslib:Library/search?$searchStr=").concat(e),d=null===(t=(await r(c)).member)||void 0===t||null===(s=t.find((t=>t.title===e)))||void 0===s?void 0:s.id;if(console.log("[All Plant Service] Library id is:",d),d){const e="".concat(o,"/resources/v1/modeler/dslib/dslib:Library/").concat(d,"?$mask=dslib:ExpandClassifiableClassesMask"),t=await r(e),{member:s}=t;if(s&&s.length>0){var n,i;console.log("[Library Data Service] Member found:",s);const e=null===(n=s[0])||void 0===n?void 0:n.ChildClasses;if((null===e||void 0===e||null===(i=e.member)||void 0===i?void 0:i.length)>0){var l;const t=null===(l=e.member[0].ChildClasses)||void 0===l?void 0:l.member;if(t&&t.length>0){const e=t.filter((e=>!a.some((t=>t.id===e.id))));a=[...a,...e]}}}}}catch(c){throw console.error("Error processing group:",e,c),c}}));return await Promise.all(i),a}catch(a){throw console.error("[All Plant Service] Error occurred:",a),a}}},2268:(e,t,o)=>{o.d(t,{I:()=>a});var s=o(6047);const a=async()=>{try{let e=window.widget.getValue("Credentials");const t=await(0,s.fV)();console.log("Security Context is:",e);const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia/resources/v1/application/CSRF?tenant=OI000186152",a=await new Promise(((e,s)=>{t.authenticatedRequest(o,{method:"GET",type:"json",onComplete:e,onFailure:s})})),n=a.csrf.name,r=a.csrf.value,i="SecurityContext",l=e;return{[n]:r,[i]:l}}catch(e){return void console.error("[CSRF] Failed to fetch token:",e)}}},174:(e,t,o)=>{o.d(t,{M:()=>s});const s=async(e,t)=>{if(console.log("[refreshWidgetData] called with dataItems:",e),e&&0!==e.length)try{if("function"!==typeof t)throw new Error("[Refresh] handleDrop is not a function.");await t(e)}catch(o){console.error("[Refresh] Error during handleDrop execution:",o)}else console.warn("[Refresh] No dropped data available to refresh.")}},4050:()=>{},4119:()=>{},9555:()=>{},9959:()=>{}}]);
//# sourceMappingURL=896.63b28c46.chunk.js.map