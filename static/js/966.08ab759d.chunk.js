"use strict";(self.webpackChunkreact_widget_template=self.webpackChunkreact_widget_template||[]).push([[966],{1358:(e,t,o)=>{o.d(t,{A:()=>l});o(5043);var s=o(8012),a=(o(4119),o(3637)),n=o(1397),r=o(4675),i=o(579);const l=e=>{let{onDrop:t}=e;const{handleDrop:o}=(0,s.A)(),{performSearch:l}=(0,r.A)(),c=t||o;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"droppable-container mt-4",children:[(0,i.jsx)(a.A,{style:{width:"90px",height:"90px"},src:"https://thewhitechamaleon.github.io/testrapp/images/drag.png",alt:"Data Collect",className:"search-icon"}),(0,i.jsx)("span",{className:"drag-and-drop-text",children:"Drag and Drop"}),(0,i.jsxs)("div",{className:"divider-container",children:[(0,i.jsx)("hr",{className:"divider"}),(0,i.jsx)("span",{className:"divider-text",children:"or"}),(0,i.jsx)("hr",{className:"divider"})]}),(0,i.jsx)(n.A,{onSearch:e=>{l(e,{title:"Search",role:"",mode:"furtive",default_with_precond:!0,precond:'flattenedtaxonomies:"types/VPMReference" OR flattenedtaxonomies:"types/Raw_Material" OR flattenedtaxonomies:"types/Document"',show_precond:!1,multiSel:!1,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",search_delegation:"3dsearch"},(e=>{e&&e.length>0&&e[0].id?c([{objectId:e[0].id,objectType:e[0]["ds6w:type_value"]}]):console.warn("No objectId found in selected objects")}))}})]})})}},6475:(e,t,o)=>{o.r(t),o.d(t,{default:()=>O});var s=o(5043),a=o(4391),n=(o(2342),o(9555),o(3003)),r=o(2670),i=o(2115),l=(o(8421),o(4050),o(9959),o(9379)),c=o(1358),d=o(3637),u=o(6713),p=o(768),g=o(759),m=o(5645),h=o(579);var v=o(2725),f=o(314),w=o(3277),A=o(2268),C=o(6047);const b=async(e,t)=>{let o={CAAtt:[]};console.log("We are into Search CA Details");const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";try{const n=await(0,C.fV)(),r=async e=>new Promise(((o,s)=>{n.authenticatedRequest(e,{method:"GET",headers:t,type:"json",onComplete:e=>{console.log("Received response:",e),o(e)},onFailure:e=>{console.error("Request failed:",e),s(e)}})}));let i="".concat(s,"/resources/v1/modeler/dsrt/routes/search?searchStr=").concat(e);const l=await r(i),c=((null===l||void 0===l?void 0:l.data)||[]).find((e=>"Route"===e.type));if(c){const t=c.identifier,a=c.state,n="".concat(s,"/resources/v1/modeler/dsrt/routes/").concat(t),i=await r(n),l=((null===i||void 0===i?void 0:i.data)||[]).find((e=>"Change Action"===e.type));if(l){const e=l.identifier,t="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(e,"?$fields=proposedChanges,flowDown"),a=await r(t);if(a)for(const n of a.isFlowDownOf||[])if("Change Action"===n.type){const e="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(n.identifier),t=await r(e);t&&o.CAAtt.push({CATitle:t.title,CAState:t.state})}}o.MCOState=a,o.MCOTitle=e}else{var a;const t=e.split("-").slice(0,2).join("-");let n="".concat(s,"/resources/v1/modeler/dslc/changeaction/search?$searchStr=name:").concat(t);const i=null===(a=(await r(n)).changeAction[0])||void 0===a?void 0:a.identifier,l="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(i,"?$fields=proposedChanges,flowDown"),c=await r(l);if(c)for(const e of c.isFlowDownOf||[])if("Change Action"===e.type){const t="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(e.identifier),a=await r(t);a&&o.CAAtt.push({CATitle:a.title,CAState:a.state})}o.MCOState="Complete",o.MCOTitle=e}return console.log("Final CA Details",o),o}catch(n){throw console.error("Error in SearchCA:",n),n}};var y=o(9722);const D=async(e,t,o,s,a)=>{try{const t="https://oi000186152-us1-space.3dexperience.3ds.com/enovia",s=await async function(e,t,o){const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia",a="".concat(s,"/resources/v1/modeler/dslc/version/getGraph");let n="";try{const r={data:[{id:e,identifier:e,type:t,source:s,relativePath:"Raw_Material"===t?"/resources/v1/modeler/dsrm/dsrm:RawMaterial/".concat(e):"/resources/v1/modeler/dseng/dseng:EngItem/".concat(e)}]},i=await(0,C.ui)("POST",a,r,o);if(i.status&&i.output){const t=i.output.results[0].versions;for(const o of t)if(o.identifier===e&&(console.log("Found matching version for ID:",e),Array.isArray(o.ancestors)&&o.ancestors.length>0)){n=o.ancestors[0].id,console.log("Ancestor ID:",n);break}return n}return console.error("API response does not contain the expected 'status' and 'output'."),n}catch(r){return console.error("Error fetching getLatestRevision for ".concat(e,":"),r),n}}(o,a,e);if(console.log("Hello getLatestRevision is Called",s),""===s)return console.warn("No latest revision ID found."),[];{const l="".concat(t,"/resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/").concat(s,"?$mask=dslib:ClassificationAttributesMask"),c=await(0,C.ui)("GET",l,"",e);if(!c.status||!c.output)return console.error("Invalid classification response from ENOVIA."),[];{var n,r;const e=((null===(n=c.output.member[0])||void 0===n||null===(r=n.ClassificationAttributes)||void 0===r?void 0:r.member)||[]).filter((e=>e.Attributes.some((e=>"PlantAssignmentClass"===e.name&&!0===e.value)))).map((e=>{const t=e.Attributes.map((e=>"Seq"===e.name?{name:e.name,value:String(Number(e.value)+1)}:"PlantStatus"===e.name?{name:e.name,value:"Pending"}:"AddSeq"===e.name||"PlantAssignmentClass"===e.name?{name:e.name,value:e.value}:{name:e.name,value:""}));return{ClassID:e.ClassID,Attributes:t}}));if(console.log("Matching ClassID and Seq:",e),!(e.length>0))return console.warn("No matching classifications found with Plant = True."),[];{const s="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/classifyProductToClass",n={id:o,type:a,classes:e.map((e=>e.ClassID)),mode:"classifyParent"};try{const a=await S("POST",s,n);console.log("classifyResponse:",JSON.stringify(a));const r={source:t,type:"dslib:CategorizationClassifiedItem",identifier:o,relativePath:"resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/".concat(o)},i=[{referencedObject:r,categorizationAttributes:e.map((e=>({classId:e.ClassID,attributes:e.Attributes.reduce(((e,t)=>(e[t.name]=t.value,e)),{})})))}];console.log("Prepared payload for second API call:",JSON.stringify(i));const l="https://saasimplementationserverdev.azurewebsites.net/plantAssignment/updateClassificationAttribute?id=".concat(o),c=await S("PATCH",l,i);return console.log("Second API call response:",JSON.stringify(c)),e}catch(i){return console.error("Error during classify or second API call:",i),[]}}}}}catch(i){return console.error("[updateClasses] Failed to process:",i),[]}};const S=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GET",t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("Fetching URL:",t),console.log("Method is:"),console.log("Request Body:",JSON.stringify(o,null,2));try{const s=await(0,y.A)({url:t,method:e,data:o});return console.log("Response received:",s.data),s}catch(s){throw console.error("Request failed:",s),s}},j=()=>{const{showErrorToast:e}=(0,v.A)(),t=(0,n.wA)();let o=window.widget.getValue("email");console.log("Email in useCompanionWidget:",o);return{handleCompanionWidget:async(s,a,n,r)=>{try{t((0,m.Ve)(!0));const i=await(0,A.I)();if(!i)return void e(w.rK);const c=await(async(e,t,o)=>{try{const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[UserGroup Status] ProductId: ",t);const a=await(0,C.fV)();let n="".concat(s,"/resources/v1/modeler/dslc/sharing/getSharing");const r=await new Promise(((o,s)=>{a.authenticatedRequest(n,{method:"POST",headers:(0,l.A)((0,l.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify({data:[{objectID:t}]}),type:"json",onComplete:o,onFailure:s})}));console.log("[Assigned Plant Service] Data received:",r);let i=[],c={groups:[]};if(r&&(r.results.forEach((e=>{e.sharings.userGroups.forEach((e=>{"Can Edit"===e.access&&c.groups.push({uri:e.userGroupID.replace(/[<>]/g,"")})}))})),c.groups.length>0)){let e="https://oi000186152-us1-usersgroup.3dexperience.3ds.com/3drdfpersist/resources/v1/usersgroup/groups?select=uri,members,title";const t=await new Promise(((t,o)=>{a.authenticatedRequest(e,{method:"POST",headers:{"Content-Type":"application/json"},data:JSON.stringify(c),type:"json",onComplete:t,onFailure:o})}));console.log("Group Response is:",t),t&&(i=t.groups.filter((e=>e.members.includes(o))).map((e=>e.title)))}return console.log("[UserGroup Status] User Groups:",i),i}catch(s){throw console.error("[UserGroup Status] Error occurred:",s),s}})(i,n,o);console.log("[ Companion ] User Groups:",c);let d=[...c,s];console.log("[Use Companion] All CollabSpaces:",d);let u=[];if(d.length>0?(u=await(async(e,t)=>{try{const o="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let s=[];console.log("[All Plant Service] CollabSpaces: ",e),console.log("[All Plant Service] headers: ",t);const a=await(0,C.fV)(),n=async e=>new Promise(((o,s)=>{a.authenticatedRequest(e,{method:"GET",headers:t,type:"json",onComplete:e=>{console.log("Received response:",e),o(e)},onFailure:e=>{console.error("Request failed:",e),s(e)}})})),r=e.map((async e=>{try{var t,a;const c="".concat(o,"/resources/v1/modeler/dslib/dslib:Library/search?$searchStr=").concat(e),d=null===(t=(await n(c)).member)||void 0===t||null===(a=t.find((t=>t.title===e)))||void 0===a?void 0:a.id;if(console.log("[All Plant Service] Library id is:",d),d){const e="".concat(o,"/resources/v1/modeler/dslib/dslib:Library/").concat(d,"?$mask=dslib:ExpandClassifiableClassesMask"),t=await n(e),{member:a}=t;if(a&&a.length>0){var r,i;console.log("[Library Data Service] Member found:",a);const e=null===(r=a[0])||void 0===r?void 0:r.ChildClasses;if((null===e||void 0===e||null===(i=e.member)||void 0===i?void 0:i.length)>0){var l;const t=null===(l=e.member[0].ChildClasses)||void 0===l?void 0:l.member;if(t&&t.length>0){const e=t.filter((e=>!s.some((t=>t.id===e.id))));s=[...s,...e]}}}}}catch(c){throw console.error("Error processing group:",e,c),c}}));return await Promise.all(r),s}catch(o){throw console.error("[All Plant Service] Error occurred:",o),o}})(d,i),console.log("[Use Companion] All Plants:",u)):console.warn("[Use Companion] No CollabSpaces found."),u.length>0){const e=await(async(e,t,o,s,a)=>{try{var n;const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";console.log("[Assigned Plant Service] Plant Members:",e);const r="".concat(s,"/resources/v1/modeler/dslib/dslib:CategorizationClassifiedItem/").concat(o,"?$mask=dslib:ClassificationAttributesMask"),i=await(0,C.fV)(),l=await new Promise(((e,o)=>{i.authenticatedRequest(r,{method:"GET",headers:t,type:"json",onComplete:e,onFailure:o})}));console.log("[Assigned Plant Service] Data received:",l);let c=[],d=[],u=(null===(n=l.member[0].ClassificationAttributes)||void 0===n?void 0:n.member)||[];u=u.filter((e=>{const t=e.Attributes.find((e=>"PlantAssignmentClass"===e.name)),o=e.Attributes.find((e=>"AllPlantsRemoved"===e.name));return!0===(null===t||void 0===t?void 0:t.value)||!0===(null===o||void 0===o?void 0:o.value)}));const p=u.some((e=>{const t=e.Attributes.find((e=>"AllPlantsRemoved"===e.name));return!0===(null===t||void 0===t?void 0:t.value)}));return 0===u.length&&(u=await D(t,0,o,0,a)),await Promise.all(u.map((async o=>{console.log("Class Item is ",o);for(let s of e)if(o.ClassID===s.id){let e=s.title;e=e.replace("Plant","").replace(/\s+/g,"");let a={id:o.ClassID,title:s.title};const n=o.Attributes.map((o=>o.name.includes("FlowDownCA")&&o.value?b(o.value,t).then((e=>{if(e){console.log(e),a.MFGChange=null===e||void 0===e?void 0:e.MCOTitle,a.MFGStatus=null===e||void 0===e?void 0:e.MCOState;let t="",o="";e.CAAtt.forEach((e=>{t+=","+e.CATitle,o+=","+e.CAState})),a.Change=t.slice(1),a.ChangeStatus=o.slice(1)}})):(a[o.name.replace(e,"").trim()]=o.value,Promise.resolve())));await Promise.all(n),c=[...c,a],console.log("Initial Assigned Classes",c),console.log("Processed Object:",a)}}))),console.log("[Assigned Plant Service] Initial Assigned Classes:",c),d=e.filter((e=>!c.some((t=>t.id===e.id)))),console.log("uniqueInAllclasses--:",d),{success:!0,data:{plantData:{allPlants:e,initialAssignedPlants:c,uniquePlants:d,hasNoClass:p}}}}catch(r){return console.error("[Object Details] Failed to fetch data:",r),{success:!1,error:r}}})(u,i,n,0,r);console.log("[Use Companion]: ",e),e.success?(t((0,m.Lq)(e.data.plantData)),t((0,m.lL)(i))):console.error("Failed to fetch plant data.")}else console.warn("[Use Companion] No Plants found.");const p=await(async(e,t,o)=>{const s="https://oi000186152-us1-space.3dexperience.3ds.com/enovia";let a=!1,n=[],r={CAName:"",CAStatus:""};const i=["caproposedwhere_from","carealizedwhere_from"],c="".concat(s,"/resources/enorelnav/v2/navigate/setPreferences");let d={widgetId:"ENORIPE_Relations_Preview_2751_2038-15:33:22",relations:["caproposedwhere_from","carealizedwhere_from"],allRelationsMode:!1,publicationsMode:!1,computeWithInstances:!1,attributesForView:["ds6w:status","ds6w:type","ds6w:identifier","ds6w:label"],label:"ENXENG_AP-e1331143-1734517777960",lang:"en",ghostMode:!1},u="".concat(s,"/resources/enorelnav/v2/navigate/getEcosystem"),p={widgetId:"ENORIPE_Relations_Preview_2751_2038-15:33:22",responseMode:"objectsByPatterns",label:"ENXENG_AP-e1331143-1734517780491",ids:[t]};try{console.log("[Get CA Details] Product ID:",t);const g=await(0,C.fV)(),m=await new Promise(((t,o)=>{g.authenticatedRequest(c,{method:"POST",headers:(0,l.A)((0,l.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(d),type:"json",onComplete:t,onFailure:o})}));if(console.log("[Get CA Details Service] Data received:",m),"OK"===m.status){const c=await new Promise(((t,o)=>{g.authenticatedRequest(u,{method:"POST",headers:(0,l.A)((0,l.A)({},e),{},{"Content-Type":"application/json"}),data:JSON.stringify(p),type:"json",onComplete:t,onFailure:o})}));console.log("[Get CA Details Service] Data received:",c);for(const l of i)c.objectsByPatterns[l]&&await Promise.all(c.objectsByPatterns[l].map((async i=>{const c=i["ds6w:status"].slice(14),d=i["ds6w:label"];if("Complete"!==c){const u="".concat(s,"/resources/v1/modeler/dslc/changeaction/").concat(i.id,"?$fields=proposedChanges,realizedChanges,flowDown"),p=await new Promise(((t,o)=>{g.authenticatedRequest(u,{method:"GET",headers:e,type:"json",onComplete:t,onFailure:o})}));console.log("response3 Data will appear:",p),"caproposedwhere_from"===l?Array.isArray(p.proposedChanges)&&p.proposedChanges.forEach((e=>{n.push({identifier:e.where.identifier,action:e.whats[0].what})})):Array.isArray(p.realizedChanges)&&p.realizedChanges.forEach((e=>{n.push({identifier:e.where.identifier,action:e.operations[0]})})),a="released"!==o.toLowerCase()||n.some((e=>e.identifier===t&&"Modify"===e.action)),a&&(r.CAName=d,r.CAStatus=c)}})))}else console.error("Unable to Fetch the ");return console.log("Status is coming inside 7"),console.log("Response Object is:",a),{success:!0,data:a,CAData:r,proposedChanges:n}}catch(g){throw console.error("Failed Request:",{url:c,headers:e,body:d,error:g}),g}})(i,n,a);console.log("[Use Companion] CA Details:",p),p.success&&(t((0,m.ug)(p.data)),t((0,m.aB)(p.proposedChanges)),t((0,m.hF)(p.CAData))),console.log("[Companion] All services executed successfully.")}catch(i){throw console.error("[Companion] Error:",i),i}finally{t((0,m.Ve)(!1))}}}},R=()=>{const{showErrorToast:e}=(0,v.A)(),{handleCompanionWidget:t}=j(),o=(0,n.d4)((e=>e.droppedObject.isDropped)),a=(0,n.d4)((e=>e.droppedObject.loading)),r=(0,n.wA)(),i=(0,s.useCallback)((async o=>{try{const n={success:!0,data:{cardData:{Title:"126758",Type:"Manufactured Material","Maturity State":"In Work",Owner:"3dxserviceuser 3dxserviceuser","Collaborative Space":"Micro Motion","Collaborative Space Title":"MSOL-Micro Motion",Description:"","Dropped Revision":"01","Dropped Revision ID":"7D56FB4B4E423B0068510DFC000030AF","Latest Released Revision":"","Latest Released Revision ID":"",EIN:"126758","CAD Format":"",imageURL:"https://oi000186152-us1-space.3dexperience.3ds.com:443/enovia/snresources/images/icons/large/I_InsertCreateMaterialProcess108x144.png",relativePath:"/resources/v1/modeler/dsmfg/dsmfg:MfgItem/7D56FB4B4E423B0068510DFC000030AF",Name:"cmt-OI000186152-00000035",organization:"Company Name","Latest Revision":"01",HasMBOM:!1}}};if(n.success){r((0,m.um)({cardData:n.data.cardData}));const e=n.data.cardData;var s,a;if(console.log("[Dragged Items are]",e),r((0,m.Rr)(!0)),n)await t(e["Collaborative Space"],e["Maturity State"],null===(s=o[0])||void 0===s?void 0:s.objectId,null===(a=o[0])||void 0===a?void 0:a.objectType)}else e(w.wX)}catch(n){console.error("[FetchObjectDetails] Error fetching details:",n),e(w.wX)}finally{r((0,m.r1)(!1))}}),[r,t]),l=(0,s.useCallback)((async t=>{(0,m.r1)(!0),console.log("[handleDrop] handleDrop called with dataItems:",t);try{t&&t.length>0?(r((0,m.Rr)(!0)),r((0,m.r1)(!1)),setTimeout((()=>r((0,m.r1)(!0))),0),await i(t)):console.warn("[handleDrop] No data items to process.")}catch(o){(0,m.r1)(!1),console.error("[Drop] Error in handleDrop:",o),console.log("[handleDrop] Error in handleDrop, setting loading to false"),e(w.nz)}}),[i,e]);return{initializeDroppableArea:(0,s.useCallback)((()=>{o?console.log("[initializeDroppableArea] \u23f3 isDropped is already true. Skipping reset."):(console.log("[initializeDroppableArea] \ud83d\ude80 Resetting isDropped to false..."),r((0,m.Rr)(!1)));const t=setInterval((()=>{const o=document.querySelector(".droppable-container");o&&(clearInterval(t),(0,f.pn)(o,l,r,e))}),100);return()=>clearInterval(t)}),[l,r]),loading:a,handleDrop:l}},P=e=>{let{onSave:t,state:o,selectedRows:s,tableData:a,onMassUpdate:n,type:r,latestRevision:i,droppedRevision:l}=e;return(0,h.jsx)("div",{className:"d-flex flex-column cta-absolute",children:(0,h.jsx)("div",{className:"d-flex"})})},x=()=>{const{initializeDroppableArea:e,loading:t}=R(),[o,a]=(0,s.useState)(0),[r,i]=(0,s.useState)([]),[f,w]=(0,s.useState)(!1),[A,C]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1),[D,S]=(0,s.useState)([]),[j,x]=(0,s.useState)([]),I=(0,n.wA)(),{showSuccessToast:E,showErrorToast:N}=(0,v.A)();(0,s.useEffect)((()=>{D.length&&i(D.map((e=>(0,l.A)((0,l.A)({},e),{},{changedCells:{}}))))}),[D]),console.log("Table Data after Adding:",r);const O=(0,n.d4)((e=>e.droppedObject.selectedTableRows)),T=(0,n.d4)((e=>e.droppedObject.droppedObjectData));console.log("droppedObjectData",T);const M=(0,n.d4)((e=>e.droppedObject.loadingParentDetails));console.log("Parents Loading State:",M);const F=(0,n.d4)((e=>e.droppedObject.plantObjectData.proposedChanges));console.log("Proposed Changes are:",F);const L=(0,n.d4)((e=>e.droppedObject.isDropped)),_=(0,n.d4)((e=>e.droppedObject.BOSObjectData));console.log("Bos data in BOS Widget is:",_);const k=(0,n.d4)((e=>e.droppedObject.BOSObjectData.specDocument));console.log("BOSObjectData",k);if(console.log("Table Data is:",r),(0,s.useEffect)((()=>{r.length>=0&&a((e=>e+1))}),[r]),T.cardData&&T.initialDraggedData)var q,G,B=T.cardData["Maturity State"],U=null===(q=T.initialDraggedData)||void 0===q||null===(G=q.data)||void 0===G?void 0:G.items[0].objectType;(0,s.useEffect)((()=>{L||e()}),[L,e]),(0,s.useEffect)((()=>{w(M)}),[M]);const z=(0,s.useMemo)((()=>((e,t)=>e?e.map((e=>{let o={Title:(null===e||void 0===e?void 0:e.childTitle)||"N/A",Revision:(null===e||void 0===e?void 0:e.childRevision)||"1",State:(null===e||void 0===e?void 0:e.childState)||"N/A"};return"Document"===t&&(o.IsLatest=(null===e||void 0===e?void 0:e.childLatest)||"FALSE"),o})):[])(k,U)),[k,U]);(0,s.useEffect)((()=>{S(z)}),[z]),(0,s.useEffect)((()=>{z.length>=0&&(console.log("New Table Data:",z),i(z),a((e=>e+1)))}),[z]);const W=(0,s.useMemo)((()=>(e=>{if(!e||!e.cardData)return null;const t=e.cardData;let o={title:t.Title||"N/A",type:t.Type||"N/A","Maturity State":t["Maturity State"]||"N/A",owner:t.Owner||"N/A","Collaborative Space Title":t["Collaborative Space Title"]||"N/A",Description:t.Description||"N/A","Dropped Revision":t["Dropped Revision"]||"N/A","Latest Released Revision":t["Latest Released Revision"]||"N/A","CAD Format":t["CAD Format"]||"N/A",imageURL:t.imageURL||"".concat("https://oi000186152-us1-space.3dexperience.3ds.com/enovia","/snresources/images/icons/large/I_VPMNavProduct108x144.png")};return"Document"!==t.Type&&(o.EIN=t.EIN||"N/A",o["CAD Format"]=t["CAD Format"]||"N/A"),o})(T)),[T]);console.log(W),(0,s.useEffect)((()=>{y(!!W)}),[W]);const V=(0,s.useMemo)((()=>((e,t,o)=>{const s=[{accessorKey:"Title",header:"Title"},{accessorKey:"Revision",header:"Revision"},{accessorKey:"State",header:"State"}];"Document"===e&&s.push({accessorKey:"IsLatest",header:"Is Latest"});const a=[].map((s=>({accessorKey:s,header:s,cell:a=>{let{row:n,getValue:r,table:i}=a;return("Document"===e?"FALSE"===n.original.IsLatest:t&&t!==o)?(0,h.jsx)("span",{children:r()}):(0,h.jsxs)("select",{value:r(),onChange:e=>{var t;const o=e.target.value,a=i.getRowModel().rows.map((e=>e.id===n.id?(0,l.A)((0,l.A)({},e.original),{},{[s]:o}):e.original));null===(t=i.options.meta)||void 0===t||t.updateTableData(a)},className:"appearance-none bg-transparent border-none cursor-pointer focus:outline-none",style:{width:"70%",padding:"5px 0",fontSize:"14px",background:"none",border:"none",textAlign:"left"},onMouseOver:e=>e.target.style.border="1px solid #ccc",onMouseOut:e=>e.target.style.border="none",children:[(0,h.jsx)("option",{value:"Yes",children:"Yes"}),(0,h.jsx)("option",{value:"No",children:"No"})]})}})));return[...s,...a]})(U,null===T||void 0===T?void 0:T.cardData["Latest Revision"],null===T||void 0===T?void 0:T.cardData["Dropped Revision"])),[U,null===T||void 0===T?void 0:T.cardData]);return(0,h.jsxs)(h.Fragment,{children:[A&&(0,h.jsxs)("div",{className:"loading-overlay",children:[(0,h.jsx)(u.A,{}),(0,h.jsx)("p",{children:"Saving..."})]}),!L&&!t&&!f&&(0,h.jsx)(c.A,{}),t&&(0,h.jsx)(u.A,{}),L&&(0,h.jsxs)(h.Fragment,{children:[t&&(0,h.jsx)(u.A,{}),(0,h.jsx)("div",{className:"content-wrapper py-3 border-bottom",children:(0,h.jsxs)("div",{className:"d-flex ",children:[(0,h.jsx)("div",{className:" p-0 pt-4",children:(0,h.jsx)(d.A,{src:"https://thewhitechamaleon.github.io/testrapp/images/home.png",alt:"home-icon",className:"home-icon",onClick:()=>{e(),I((0,m.Rr)(!1)),I((0,m.um)({cardData:{},parentDetails:[],versions:[],initialDraggedData:[]})),i([]),y(!1)}})}),W&&(0,h.jsx)(g.A,{data:W,widgetType:"bosWidget"})]})}),f?(0,h.jsx)("div",{className:"loading-indicator mt-5",children:(0,h.jsx)(u.A,{})}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"wrapper-cta",children:[(0,h.jsx)(P,{type:U,latestRevision:null===T||void 0===T?void 0:T.cardData["Latest Revision"],droppedRevision:null===T||void 0===T?void 0:T.cardData["Dropped Revision"],selectedRows:O,state:B,tableData:j}),(0,h.jsx)(p.A,{data:r,columns:V,meta:{updateTableData:e=>{const t=e.map((e=>{const t=D.find((t=>t.Title===e.Title&&t.Revision===e.Revision));if(!t)return(0,l.A)((0,l.A)({},e),{},{changedCells:{}});const o={};return Object.keys(e).forEach((s=>{e[s]!==t[s]&&(o[s]=!0)})),(0,l.A)((0,l.A)({},e),{},{changedCells:o})}));i(t)}},type:U,latestRevision:null===T||void 0===T?void 0:T.cardData["Latest Revision"],droppedRevision:null===T||void 0===T?void 0:T.cardData["Dropped Revision"],widgetType:"companion_Widget",onSelectableRowsChange:x},o)]})})]})]})};var I=o(174);const E=()=>{const{handleDrop:e}=R(),{showSuccessToast:t,showErrorToast:o}=(0,v.A)(),[a,n]=(0,s.useState)(!1);console.log("---[WidgetLifecycle]--- starts");return(0,s.useEffect)((()=>{if(!window.widget)return;console.trace("[WidgetLifecycle] \ud83d\udd04 `onRefresh` was called from:"),window.widget.addEvent("onRefresh",(async()=>{var s,a;const i=(new Error).stack.split("\n"),l=sessionStorage.getItem("userClickedRefresh");if((e=>e.some((e=>e.includes("UWA_Frame_Alone.js")||e.includes("bundle-min.js"))))(i)&&!l)return void console.warn("[WidgetLifecycle] \u26d4 Auto-refresh detected. Ignoring unwanted `onRefresh`.");sessionStorage.removeItem("userClickedRefresh"),n(!0);const c=r.A.getState().droppedObject.droppedObjectData.initialDraggedData;if(null===c||void 0===c||null===(s=c.data)||void 0===s||null===(a=s.items)||void 0===a||!a.length)return console.error("[WidgetLifecycle] \u26a0\ufe0f `initialDraggedData` is missing or invalid:",c),void n(!1);try{await(0,I.M)(c.data.items,e)}catch(d){console.error("[WidgetLifecycle] \u274c Error during refresh:",d),o(w.H6)}finally{n(!1),t(w._l)}}))}),[]),a?(0,h.jsx)(u.A,{}):null};o(8885);let N=null;function O(){if(window.widget){let e=!1;window.widget.addEvent("onLoad",(()=>{e?console.warn("[index.js] \u23f3 onLoad was already executed. Ignoring duplicate trigger."):(e=!0,function(){var e,t;requirejs(["DS/PlatformAPI/PlatformAPI"],(e=>{window.PlatformAPI=e}));let o=(null===(e=window.widget)||void 0===e||null===(t=e.body)||void 0===t?void 0:t.querySelector("#root"))||document.getElementById("root");o||(o=document.createElement("div"),o.id="root",window.widget&&window.widget.body?window.widget.body.appendChild(o):document.body.appendChild(o)),N||(N=a.createRoot(o)),N.render((0,h.jsxs)(n.Kq,{store:r.A,children:[(0,h.jsx)(E,{}),(0,h.jsx)(x,{}),(0,h.jsx)(i.N9,{})]}))}())}))}else console.error("[index.js] \u274c Widget not detected! onLoad cannot be registered.")}!function(){if(window.parent&&window.parent.document){let e=window.parent.document.createElement("script");e.textContent='\n    function listenForRefreshClicks() {\n      // console.log("\ud83c\udf0d [Parent] Listening for manual refresh clicks...");\n\n      document.body.addEventListener("click", function (event) {\n        let refreshButton = event.target.closest("#refresh"); // Check if refresh was clicked\n\n        if (refreshButton) {\n          // console.log("\u2705 [Parent] User clicked Refresh!");\n          sessionStorage.setItem("userClickedRefresh", "true"); // Store flag\n          // console.log("Stored Flag:", sessionStorage.getItem("userClickedRefresh"));\n        }\n      }, true);\n    }\n\n    // \u2705 Ensure event listener is added even if DOM is already loaded\n    if (document.readyState === "loading") {\n      document.addEventListener("DOMContentLoaded", listenForRefreshClicks);\n    } else {\n      listenForRefreshClicks();\n    }\n  ',window.parent.document.body.appendChild(e)}else console.warn("\u26a0\ufe0f [index.js] Unable to inject script\u2014parent window not accessible.")}()}}]);
//# sourceMappingURL=966.08ab759d.chunk.js.map