{"version":3,"file":"static/js/282.24da9a6d.chunk.js","mappings":"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","sources":["hooks/useCompanion.js","hooks/useCompanianDropableArea.js","pages/companionWidget/WidgetLifecycle.jsx","pages/companionWidget/DragAndDrop.jsx","pages/companionWidget/companion.jsx","pages/companionWidget/companionIndex.js"],"sourcesContent":["// Minimal hook for companion widget: all services and business logic removed.\r\n// Only provides drop state and a way to set dropped data for drag-and-drop widget.\r\nimport { useState } from \"react\";\r\n\r\nconst useCompanion = () => {\r\n  const [droppedData, setDroppedData] = useState(null);\r\n  const [isDropped, setIsDropped] = useState(false);\r\n\r\n  // Call this when an object is dropped\r\n  const handleDrop = (data) => {\r\n    setDroppedData(data);\r\n    setIsDropped(true);\r\n  };\r\n\r\n  // Call this to reset the widget\r\n  const resetDrop = () => {\r\n    setDroppedData(null);\r\n    setIsDropped(false);\r\n  };\r\n\r\n  return { droppedData, isDropped, handleDrop, resetDrop };\r\n};\r\n\r\nexport default useCompanion;\r\n","// Minimal drop area hook for companion widget: all services and Redux removed.\r\n// Only provides drop state and handlers for drag-and-drop widget.\r\nimport useCompanion from \"./useCompanion\";\r\n\r\nconst useCompanianDropableArea = () => {\r\n  // Use the minimal drop state from useCompanion\r\n  const { droppedData, isDropped, handleDrop, resetDrop } = useCompanion();\r\n\r\n  // Optionally, you can expose initializeDroppableArea if you want to reset\r\n  const initializeDroppableArea = resetDrop;\r\n\r\n  // No loading state or Redux\r\n  return {\r\n    initializeDroppableArea,\r\n    isDropped,\r\n    droppedData,\r\n    handleDrop,\r\n  };\r\n};\r\n\r\nexport default useCompanianDropableArea;","import React, { useEffect, useState } from \"react\";\r\nimport { refreshWidgetData } from \"../../services/api/refreshService\";\r\nimport useToast from \"../../hooks/useToast\";\r\nimport { MSG_REFRESH_ERROR, MSG_REFRESH_SUCCESS } from \"../../utils/toastMessages\";\r\nimport store from \"../../store\"; // ‚úÖ Import Redux store directly\r\nimport Loader from \"../../components/Loader/Loader\";\r\nimport useCompanianDropableArea from \"../../hooks/useCompanianDropableArea\";\r\n\r\nconst WidgetLifecycle = () => {\r\n  const { handleDrop } = useCompanianDropableArea();\r\n  const { showSuccessToast, showErrorToast } = useToast();\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  console.log(\"---[WidgetLifecycle]--- starts\");\r\n\r\n  const isAutoTriggeredRefresh = (trace) => {\r\n    return trace.some(\r\n      (line) =>\r\n        line.includes(\"UWA_Frame_Alone.js\") || line.includes(\"bundle-min.js\")\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!window.widget) return;\r\n\r\n    // console.log(\"[WidgetLifecycle] üìå Registering `onRefresh` event...\");\r\n\r\n    const onRefresh = async () => {\r\n      const trace = new Error().stack.split(\"\\n\");\r\n\r\n      // ‚úÖ Check if refresh was manually triggered\r\n      const userClickedRefresh = sessionStorage.getItem(\"userClickedRefresh\");\r\n\r\n      if (isAutoTriggeredRefresh(trace) && !userClickedRefresh) {\r\n        console.warn(\r\n          \"[WidgetLifecycle] ‚õî Auto-refresh detected. Ignoring unwanted `onRefresh`.\"\r\n        );\r\n        return; // ‚úÖ Block auto-triggered refresh\r\n      }\r\n\r\n      // console.log(\"[WidgetLifecycle] üîÑ `onRefresh` triggered!\");\r\n      // ‚úÖ Reset manual refresh flag so next refresh isn't blocked\r\n      sessionStorage.removeItem(\"userClickedRefresh\");\r\n      // console.log(\r\n      //   \"Stored Flag in widgt lifecycle:\",\r\n      //   sessionStorage.getItem(\"userClickedRefresh\")\r\n      // );\r\n\r\n      setLoading(true);\r\n\r\n      const latestState = store.getState();\r\n      const latestDraggedData =\r\n        latestState.droppedObject.droppedObjectData.initialDraggedData;\r\n\r\n      if (!latestDraggedData?.data?.items?.length) {\r\n        console.error(\r\n          \"[WidgetLifecycle] ‚ö†Ô∏è `initialDraggedData` is missing or invalid:\",\r\n          latestDraggedData\r\n        );\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        // console.log(\r\n        //   \"[WidgetLifecycle] üöÄ Refreshing widget with latest data...\"\r\n        // );\r\n        await refreshWidgetData(latestDraggedData.data.items, handleDrop);\r\n      } catch (error) {\r\n        console.error(\"[WidgetLifecycle] ‚ùå Error during refresh:\", error);\r\n        showErrorToast(MSG_REFRESH_ERROR);\r\n      } finally {\r\n        setLoading(false); // ‚úÖ Stop Loader when refresh completes\r\n        showSuccessToast(MSG_REFRESH_SUCCESS);\r\n      }\r\n    };\r\n    console.trace(\"[WidgetLifecycle] üîÑ `onRefresh` was called from:\");\r\n    window.widget.addEvent(\"onRefresh\", onRefresh);\r\n    // console.log(\r\n    //   \"[WidgetLifecycle] ‚úÖ `onRefresh` event registered successfully\"\r\n    // );\r\n  }, []); // ‚úÖ Runs only once\r\n\r\n  return loading ? <Loader/> : null;\r\n};\r\n\r\nexport default WidgetLifecycle;\r\n","// Copy of plantAssignment/DragAndDrop.jsx for companionWidget\r\nimport React, { useEffect } from \"react\";\r\nimport \"../../components/DragAndDrop/DragAndDrop.css\";\r\nimport { Button, Form, Image } from \"react-bootstrap\";\r\nimport SearchInput from \"../../components/SearchInput/SearchInput\";\r\nimport useInterComSearch from \"../../hooks/useInterComSearch\";\r\nimport usePlantDropableArea from \"../../hooks/usePlantDropableArea\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faRotateLeft } from \"@fortawesome/free-solid-svg-icons\";\r\nimport \"./companionWidget.css\";\r\n\r\nconst DragAndDropComponent = ({\r\n  handleFileInputChange,\r\n  fileInputRef,\r\n  isFileInputDisabled,\r\n  handleSubmit,\r\n  isCreateButtonDisabled,\r\n  handleReset,\r\n}) => {\r\n  const { handleDrop } = usePlantDropableArea();\r\n  const { performSearch } = useInterComSearch();\r\n\r\n  const handleSearch = (searchText) => {\r\n    const searchOpts = {\r\n      title: \"Search\",\r\n      role: \"\",\r\n      mode: \"furtive\",\r\n      default_with_precond: true,\r\n      precond:\r\n        'flattenedtaxonomies:\"types/VPMReference\" OR flattenedtaxonomies:\"types/Raw_Material\" OR flattenedtaxonomies:\"types/Document\"',\r\n      show_precond: false,\r\n      multiSel: false,\r\n      idcard_activated: false,\r\n      select_result_max_idcard: false,\r\n      itemViewClickHandler: \"\",\r\n      search_delegation: \"3dsearch\",\r\n    };\r\n\r\n    const handleSearchResults = (selectedObjects) => {\r\n      console.log(\"Selected objects:\", selectedObjects);\r\n      console.log(\"objectId: selectedObjects[0].id\", selectedObjects[0].id);\r\n      if (\r\n        selectedObjects &&\r\n        selectedObjects.length > 0 &&\r\n        selectedObjects[0].id\r\n      ) {\r\n        handleDrop([\r\n          {\r\n            objectId: selectedObjects[0].id,\r\n            objectType: selectedObjects[0][\"ds6w:type_value\"],\r\n          },\r\n        ]);\r\n      } else {\r\n        console.warn(\"No objectId found in selected objects\");\r\n      }\r\n    };\r\n\r\n    performSearch(searchText, searchOpts, handleSearchResults);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"droppable-container mt-4\">\r\n        <Image\r\n          style={{ width: \"90px\", height: \"65px\" }}\r\n          src=\"https://thewhitechamaleon.github.io/testrapp/images/drag.png\"\r\n          alt=\"Data Collect\"\r\n          className=\"search-icon\"\r\n        />\r\n        <span className=\"drag-and-drop-text\">Drag and Drop</span>\r\n        <div className=\"divider-container\">\r\n          <hr className=\"divider\" />\r\n          <span className=\"divider-text\">or</span>\r\n          <hr className=\"divider\" />\r\n        </div>\r\n        <SearchInput onSearch={handleSearch} />\r\n        <div className=\"mt-3\">\r\n          <div className=\"row justify-content-center\">\r\n            <div className=\"col-6 col-md-auto mb-2\">\r\n              <Button\r\n                variant=\"link ms-auto\"\r\n                onClick={() => {\r\n                  const link = document.createElement(\"a\");\r\n                  link.href =\r\n                    \"https://github.com/aayush825/EMR_PLANT_WIDGET/raw/main/plant_assignment_template.xlsx\";\r\n                  link.download = \"plant_assignment_template.xlsx\";\r\n                  link.click();\r\n                }}\r\n              >\r\n                Download Template\r\n              </Button>\r\n            </div>\r\n            <div className=\"col-6 col-md-auto mb-2\">\r\n              <Form.Group controlId=\"formFileMultiple\">\r\n                <Form.Control\r\n                  type=\"file\"\r\n                  multiple\r\n                  onChange={handleFileInputChange}\r\n                  disabled={isFileInputDisabled}\r\n                  ref={fileInputRef}\r\n                />\r\n              </Form.Group>\r\n            </div>\r\n            <div className=\"col-6 col-md-auto mb-2\">\r\n              <Button variant=\"outline-danger\" onClick={handleReset}>\r\n                <FontAwesomeIcon icon={faRotateLeft} />\r\n              </Button>\r\n            </div>\r\n            <div className=\"col-6 col-md-auto mb-2\">\r\n              <div\r\n                style={{\r\n                  display: \"inline-block\",\r\n                  cursor: isCreateButtonDisabled ? \"not-allowed\" : \"pointer\",\r\n                }}\r\n              >\r\n                <Button\r\n                  variant={\r\n                    isCreateButtonDisabled ? \"secondary\" : \"outline-primary\"\r\n                  }\r\n                  onClick={handleSubmit}\r\n                  disabled={isCreateButtonDisabled}\r\n                >\r\n                  Create Manufacturing CA\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DragAndDropComponent;\r\n","import React, { useState, useRef } from \"react\";\r\nimport DragAndDropComponent from \"./DragAndDrop\";\r\nimport \"./companionWidget.css\";\r\n\r\nconst CompanionWidget = () => {\r\n  // Only minimal state for drag and drop\r\n  const [isDropped, setIsDropped] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const fileInputRef = useRef(null);\r\n  const [isFileInputDisabled, setIsFileInputDisabled] = useState(false);\r\n  const [isCreateButtonDisabled, setIsCreateButtonDisabled] = useState(true);\r\n\r\n  // Dummy handlers for drag and drop\r\n  const handleFileInputChange = () => {};\r\n  const handleSubmit = () => {};\r\n  const handleReset = () => {};\r\n\r\n  // Show only drag and drop and empty table after drop\r\n  return (\r\n    <>\r\n      {!isDropped && !loading && (\r\n        <div\r\n          style={{\r\n            height: \"100%\",\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            justifyContent: \"space-between\",\r\n            position: \"relative\",\r\n          }}\r\n        >\r\n          <DragAndDropComponent\r\n            handleFileInputChange={handleFileInputChange}\r\n            fileInputRef={fileInputRef}\r\n            isFileInputDisabled={isFileInputDisabled}\r\n            handleSubmit={handleSubmit}\r\n            isCreateButtonDisabled={isCreateButtonDisabled}\r\n            handleReset={handleReset}\r\n          />\r\n        </div>\r\n      )}\r\n      {isDropped && (\r\n        <div className=\"content-wrapper py-3 border-bottom\">\r\n          <div className=\"d-flex \">\r\n            <div className=\" p-0 pt-4\">\r\n              {/* Home icon or any other UI can go here if needed */}\r\n            </div>\r\n            {/* Only show empty table after drop */}\r\n            <div style={{ width: \"100%\" }}>\r\n              <table className=\"table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Plant</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {/* No data rows */}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CompanionWidget;\r\n","import React, { useEffect } from \"react\";\r\nimport ReactDOM from \"react-dom/client\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport \"../../index.css\";\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"../../store\";\r\nimport { ToastContainer } from \"react-toastify\";\r\n// import { io } from \"socket.io-client\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"../../App.css\";\r\nimport \"../../styles/variables.css\";\r\nimport WidgetLifecycle from \"./WidgetLifecycle\";\r\nimport Companion from \"./companion\";\r\n\r\n// This function mounts the React app.\r\nlet root = null; // Global React root\r\nexport function start() {\r\n  requirejs([\"DS/PlatformAPI/PlatformAPI\"], (PlatformAPI) => {\r\n    window.PlatformAPI = PlatformAPI;\r\n  });\r\n  // console.log(\"[index.js] start() called. Mounting React app.\");\r\n  // Find the root element within the widget's body (if available)\r\n  let rootElement =\r\n    window.widget?.body?.querySelector(\"#root\") ||\r\n    document.getElementById(\"root\");\r\n\r\n  // If no root element exists, create one and append it to the widget body or document body.\r\n  if (!rootElement) {\r\n    rootElement = document.createElement(\"div\");\r\n    rootElement.id = \"root\";\r\n    if (window.widget && window.widget.body) {\r\n      window.widget.body.appendChild(rootElement);\r\n      // console.log(\"[index.js] Root element appended to widget.body.\");\r\n    } else {\r\n      document.body.appendChild(rootElement);\r\n      // console.log(\"[index.js] Root element appended to document.body.\");\r\n    }\r\n  } else {\r\n    // console.log(\"[index.js] Root element found.\");\r\n  }\r\n\r\n  if (!root) {\r\n    // console.log(\"[index.js] Creating new React root.\");\r\n    root = ReactDOM.createRoot(rootElement);\r\n  } else {\r\n    // console.log(\"[index.js] Reusing existing React root.\");\r\n  }\r\n\r\n  root.render(\r\n    <Provider store={store}>\r\n      <WidgetLifecycle />\r\n      <Companion />\r\n      <ToastContainer />\r\n    </Provider>\r\n  );\r\n  // console.log(\"[index.js] React app rendered.\");\r\n}\r\n\r\n// Function to inject the refresh listener script into the **parent window**\r\nfunction injectRefreshListener() {\r\n  // console.log(\"üåç [index.js] Injecting refresh listener into parent window...\");\r\n\r\n  const scriptContent = `\r\n    function listenForRefreshClicks() {\r\n      // console.log(\"üåç [Parent] Listening for manual refresh clicks...\");\r\n\r\n      document.body.addEventListener(\"click\", function (event) {\r\n        let refreshButton = event.target.closest(\"#refresh\"); // Check if refresh was clicked\r\n\r\n        if (refreshButton) {\r\n          // console.log(\"‚úÖ [Parent] User clicked Refresh!\");\r\n          sessionStorage.setItem(\"userClickedRefresh\", \"true\"); // Store flag\r\n          // console.log(\"Stored Flag:\", sessionStorage.getItem(\"userClickedRefresh\"));\r\n        }\r\n      }, true);\r\n    }\r\n\r\n    // ‚úÖ Ensure event listener is added even if DOM is already loaded\r\n    if (document.readyState === \"loading\") {\r\n      document.addEventListener(\"DOMContentLoaded\", listenForRefreshClicks);\r\n    } else {\r\n      listenForRefreshClicks();\r\n    }\r\n  `;\r\n\r\n  // Inject script **into the parent window**\r\n  if (window.parent && window.parent.document) {\r\n    let injectedScript = window.parent.document.createElement(\"script\");\r\n    injectedScript.textContent = scriptContent;\r\n    window.parent.document.body.appendChild(injectedScript);\r\n    // console.log(\"‚úÖ [index.js] Script successfully injected and executed in parent!\");\r\n  } else {\r\n    console.warn(\"‚ö†Ô∏è [index.js] Unable to inject script‚Äîparent window not accessible.\");\r\n  }\r\n}\r\n\r\n// ‚úÖ Inject the script when the React app starts\r\ninjectRefreshListener();\r\n\r\n// Export a default function for dynamic import compatibility\r\nexport default function () {\r\n  if (window.widget) {\r\n    start();\r\n  }\r\n}\r\n"],"names":["useCompanion","droppedData","setDroppedData","useState","isDropped","setIsDropped","handleDrop","data","resetDrop","useCompanianDropableArea","initializeDroppableArea","WidgetLifecycle","showSuccessToast","showErrorToast","useToast","loading","setLoading","console","log","useEffect","window","widget","trace","addEvent","async","_latestDraggedData$da","_latestDraggedData$da2","Error","stack","split","userClickedRefresh","sessionStorage","getItem","some","line","includes","isAutoTriggeredRefresh","warn","removeItem","latestDraggedData","store","getState","droppedObject","droppedObjectData","initialDraggedData","items","length","error","refreshWidgetData","MSG_REFRESH_ERROR","MSG_REFRESH_SUCCESS","_jsx","Loader","_ref","handleFileInputChange","fileInputRef","isFileInputDisabled","handleSubmit","isCreateButtonDisabled","handleReset","usePlantDropableArea","performSearch","useInterComSearch","_Fragment","children","_jsxs","className","Image","style","width","height","src","alt","SearchInput","onSearch","searchText","title","role","mode","default_with_precond","precond","show_precond","multiSel","idcard_activated","select_result_max_idcard","itemViewClickHandler","search_delegation","selectedObjects","id","objectId","objectType","Button","variant","onClick","link","document","createElement","href","download","click","Form","Group","controlId","Control","type","multiple","onChange","disabled","ref","FontAwesomeIcon","icon","faRotateLeft","display","cursor","CompanionWidget","useRef","setIsFileInputDisabled","setIsCreateButtonDisabled","flexDirection","justifyContent","position","DragAndDropComponent","root","start","_window$widget","_window$widget$body","requirejs","PlatformAPI","rootElement","body","querySelector","getElementById","appendChild","ReactDOM","render","Provider","Companion","ToastContainer","parent","injectedScript","textContent","injectRefreshListener"],"sourceRoot":""}